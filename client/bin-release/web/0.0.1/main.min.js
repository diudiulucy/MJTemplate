var __reflect=this&&this.__reflect||function(t,e,n){t.__class__=e,n?n.push(e):n=[e],t.__types__=t.__types__?n.concat(t.__types__):n},__extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),LC;!function(t){var e=function(){function e(){this.TAG="",this.SocketEventList=null,this.TAG=egret.getQualifiedClassName(this),this.init(),this._registerManySockets(!0)}return e.prototype.init=function(){this.SocketEventList=new Array,this.registerSockets()},e.prototype._registerManySockets=function(e){for(var n=0,r=this.SocketEventList;n<r.length;n++){var i=r[n],o=i.toString(),s="on_"+o+"_event";this[s]?e?t.EventManager.getInstance().register(o,this[s],this):t.EventManager.getInstance().unRegister(o,this[s],this):console.error("未添加"+this.TAG+"的"+s+"的监听")}},e.prototype.registerSockets=function(){},e.prototype.unRegisterSockets=function(){},e.prototype.onDestroy=function(){this.unRegisterSockets(),this._registerManySockets(!1),this.SocketEventList=null},e}();t.Controller=e,__reflect(e.prototype,"LC.Controller")}(LC||(LC={}));var LC;!function(t){var e=function(e){function n(){var t=e.call(this)||this;return t.TAG="",t.UIEventList=null,t.TAG=egret.getQualifiedClassName(t),t.addEventListener(egret.Event.ADDED_TO_STAGE,t.init,t),t.addEventListener(egret.Event.REMOVED_FROM_STAGE,t.onDestroy,t),t}return __extends(n,e),n.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this)},Object.defineProperty(n.prototype,"Ctrl",{get:function(){return this._ctrl},set:function(t){this._ctrl=t},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"Size",{set:function(t){},enumerable:!0,configurable:!0}),n.prototype.init=function(){this.UIEventList=new Array,this.setOnTouchListener(),this.registerCustomEvents(),this._registerManyUIEvents(!0),this.watchData()},n.prototype.watchData=function(){},n.prototype._registerManyUIEvents=function(e){if(this.UIEventList)for(var n=0,r=this.UIEventList;n<r.length;n++){var i=r[n],o=i.toString(),s="ui_"+o;this[s]?e?t.EventManager.getInstance().register(o,this[s],this):t.EventManager.getInstance().unRegister(o,this[s],this):console.error("未添加"+this.TAG+"的"+s+"的监听")}},n.prototype.setOnTouchListener=function(){},n.prototype.removeOnTouchListener=function(){},n.prototype.registerCustomEvents=function(){},n.prototype.unRegisterCustomEvents=function(){},n.prototype.onEnterTransitionDidFinish=function(){},n.prototype.onExitTransitionDidStart=function(){},n.prototype.onDestroy=function(){this.removeOnTouchListener(),this.unRegisterCustomEvents(),this._registerManyUIEvents(!1),this.UIEventList=null,this.Ctrl&&this.Ctrl.onDestroy(),this.Ctrl=null},n}(eui.Component);t.Layer=e,__reflect(e.prototype,"LC.Layer")}(LC||(LC={}));var LC;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.TAG="",e.TAG=egret.getQualifiedClassName(e),e.addEventListener(egret.Event.ADDED_TO_STAGE,e.init,e),e.addEventListener(egret.Event.REMOVED_FROM_STAGE,e.onDestroy,e),e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this._isRunning=!0},Object.defineProperty(e.prototype,"isRunning",{get:function(){return this._isRunning},enumerable:!0,configurable:!0}),e.prototype.init=function(){},e.prototype.onEnterTransitionDidFinish=function(){},e.prototype.onExitTransitionDidStart=function(){},e.prototype.unLoadAsset=function(){console.log(this.TAG+" unLoadAsset")},e.prototype.onDestroy=function(){this.removeChildren(),this.unLoadAsset()},e}(eui.UILayer);t.Scene=e,__reflect(e.prototype,"LC.Scene")}(LC||(LC={}));var LC;!function(t){var e=function(){function t(){}return t.getInstance=function(){var t=egret.getQualifiedClassName(this),e=egret.getDefinitionByName(t);return this.instance||(this.instance=new e),this.instance},t}();t.Single=e,__reflect(e.prototype,"LC.Single")}(LC||(LC={}));var LC;!function(t){var e=function(){function t(){}return t.default_res_json="resource/default.res.json",t.default_thm_json="resource/default.thm.json",t.default_resource="resource/",t.SERVER_URL="ws://192.168.1.101:20000",t.MD5PASS="8222b2020c704671b9c51d6fdcfe776c",t.MaxPlayerCount=4,t}();t.Config=e,__reflect(e.prototype,"LC.Config"),t.WEB_URL="http://119.23.66.138:50002/majapi/"}(LC||(LC={}));var Main=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isThemeLoadEnd=!1,e.isResourceLoadEnd=!1,e}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this),egret.lifecycle.addLifecycleListener(function(t){}),egret.lifecycle.onPause=function(){egret.ticker.pause(),console.log("app 进入后台")},egret.lifecycle.onResume=function(){egret.ticker.resume(),console.log("app 进入前台")};var e=new AssetAdapter;egret.registerImplementation("eui.IAssetAdapter",e),egret.registerImplementation("eui.IThemeAdapter",new ThemeAdapter),RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.loadConfig(LC.Config.default_res_json,LC.Config.default_resource),LC.ResUtil.Instance.loadGroup("loading",this,this._onResourceLoadingComplete,null,1),LC.ResUtil.Instance.loadGroup("preload",this,this._onResourcePreLoadComplete,this._onPreloadResourceProgress)},e.prototype.onConfigComplete=function(t){RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this);var e=new eui.Theme(LC.Config.default_thm_json,this.stage);e.addEventListener(eui.UIEvent.COMPLETE,this.onThemeLoadComplete,this)},e.prototype.onThemeLoadComplete=function(){this.isThemeLoadEnd=!0,this.createScene()},e.prototype._onResourceLoadingComplete=function(t){this.parent.removeChild(this),this.loadingScene=new LC.LoadingScene,LC.SceneManager.Instance.runWithScene(this.loadingScene)},e.prototype._onResourcePreLoadComplete=function(t){this.isResourceLoadEnd=!0,this.createScene()},e.prototype.createScene=function(){if(this.isThemeLoadEnd&&this.isResourceLoadEnd){LC.Tips.Instance.setLayer(this.stage),LC.ErrorCodeManager.Instance.init("error_txt");var t=new LC.LoginScene;LC.SceneManager.Instance.replaceScene(t)}},e.prototype._onPreloadResourceProgress=function(t){this.loadingScene.loadingView.setProgress(t.itemsLoaded,t.itemsTotal)},e}(eui.UILayer);__reflect(Main.prototype,"Main");var ThemeAdapter=function(){function t(){}return t.prototype.getTheme=function(t,e,n,r){function i(t){e.call(r,t)}function o(e){e.resItem.url==t&&(RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,o,null),n.call(r))}RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,o,null),RES.getResByUrl(t,i,this,RES.ResourceItem.TYPE_TEXT)},t}();__reflect(ThemeAdapter.prototype,"ThemeAdapter",["eui.IThemeAdapter"]);var LC;!function(t){var e=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this._mc=new egret.MovieClip,this._mc.movieClipData=this._mcDataFactory.generateMovieClipData(this._mcLink),this.anchorOffsetX=this.width/2,this.anchorOffsetY=this.height/2,this.horizontalCenter=0,this.verticalCenter=0,this.addChild(this._mc),this.play(-1)},Object.defineProperty(e.prototype,"MC",{get:function(){return this._mc},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mcLink",{get:function(){return this._mcLink},set:function(t){this._mcLink=t;var e=RES.getRes(t+"_mc_json"),n=RES.getRes(t+"_tex_png");this._mcDataFactory=new egret.MovieClipDataFactory(e,n)},enumerable:!0,configurable:!0}),e.prototype.stop=function(){this._mc&&this._mc.stop()},e.prototype.play=function(t){this._mc&&this._mc.play(t)},e}(eui.Component);t.MCPlayer=e,__reflect(e.prototype,"LC.MCPlayer")}(LC||(LC={}));var LC;!function(t){var e=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.map={},e}return __extends(e,t),Object.defineProperty(e,"Instance",{get:function(){return this.getInstance()},enumerable:!0,configurable:!0}),e.prototype.init=function(t){var e=this,n=RES.getRes(t);console.assert(""!=n,"read file failed"),n.replace(/\r/g,"");var r=n.split("\n");r.forEach(function(t){if(-1!=t.indexOf(":")){var n=t.split(":");e.map[n[0]]=n[1]}})},e.prototype.getErrorCode=function(t){var e=this.map[t];return e||"code not found"+t},e}(t.Single);t.ErrorCodeManager=e,__reflect(e.prototype,"LC.ErrorCodeManager")}(LC||(LC={}));var LC;!function(t){var e=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.getInstance=function(){return this.instance||(e.instance=new e),e.instance},e.prototype.dispatchCustomEvent=function(t,n){e.instance.dispatchEventWith(t,!1,n)},e.prototype.register=function(t,n,r){e.instance.addEventListener(t,n,r)},e.prototype.unRegister=function(t,n,r){e.instance.removeEventListener(t,n,r)},e}(egret.EventDispatcher);t.EventManager=e,__reflect(e.prototype,"LC.EventManager")}(LC||(LC={}));var LC;!function(t){var e=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._runningScene=null,e._scenesStack=[],e._nextScene=null,e}return __extends(e,t),Object.defineProperty(e,"Instance",{get:function(){return this.getInstance()},enumerable:!0,configurable:!0}),e.prototype._setNextScene=function(){egret.MainContext.instance.stage.addChild(this._nextScene),this._runningScene&&this._runningScene.onExitTransitionDidStart(),this._nextScene.onEnterTransitionDidFinish(),this._sendCleanupToScene&&this._runningScene&&this._runningScene.parent.removeChild(this._runningScene),this._runningScene=this._nextScene,this._nextScene=null},e.prototype.runWithScene=function(t){console.assert(null!=t,"This command can only be used to start the SceneManager. There is already a scene present."),console.assert(null==this._runningScene,"_runningScene should be null"),this.pushScene(t)},e.prototype.replaceScene=function(t){if(console.assert(null!=t,"the scene should not be null"),null==this._runningScene)return void this.runWithScene(t);if(t!=this._nextScene){this._nextScene&&(this._nextScene.isRunning&&this._nextScene.parent.removeChild(this._nextScene),this._nextScene=null),this._sendCleanupToScene=!0;var e=this._scenesStack.length;this._scenesStack.splice(e-1,1,t),this._nextScene=t,this._setNextScene()}},e.prototype.pushScene=function(t){console.assert(null!=t,"the scene should not null"),this._sendCleanupToScene=!1,this._scenesStack.push(t),this._nextScene=t,this._setNextScene()},e.prototype.popScene=function(){console.assert(null!=this._runningScene,"running scene should not null"),this._scenesStack.pop();var t=this._scenesStack.length;0==t||(this._sendCleanupToScene=!0,this._nextScene=this._scenesStack[t-1],this._setNextScene())},Object.defineProperty(e.prototype,"runningScene",{get:function(){return this._runningScene},enumerable:!0,configurable:!0}),e.prototype.end=function(){},e.prototype.pause=function(){},e.prototype.resume=function(){},e}(t.Single);t.SceneManager=e,__reflect(e.prototype,"LC.SceneManager")}(LC||(LC={}));var LC;!function(t){t.AESKEY="@ZYHD#GDMJ!112233!love**foreverX"}(LC||(LC={}));var LC;!function(t){var e=function(){function t(){}return t.post=function(t,e,n,r,i,o){console.log("post url = "+t);var s=new egret.HttpRequest;if(s.responseType=egret.HttpResponseType.TEXT,s.open(t,egret.HttpMethod.POST),s.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),e)if(e instanceof Object){var a=this.changeUrlCode(e);s.send(a)}else s.send(e);else s.send();n&&s.addEventListener(egret.Event.COMPLETE,n,r),i&&s.addEventListener(egret.IOErrorEvent.IO_ERROR,i,r),o&&s.addEventListener(egret.ProgressEvent.PROGRESS,o,r)},t.get=function(t,e,n,r,i){console.log("get url = "+t);var o=new egret.HttpRequest;if(o.responseType=egret.HttpResponseType.TEXT,e){var s=this.changeUrlCode(e);o.open(t+"?"+s,egret.HttpMethod.GET)}else o.open(t,egret.HttpMethod.GET);o.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),o.send(),n&&o.addEventListener(egret.Event.COMPLETE,n,r),i&&o.addEventListener(egret.IOErrorEvent.IO_ERROR,i,r)},t.changeUrlCode=function(t){if(!t)return null;var e="";for(var n in t)e+=n+"="+t[n]+"&";return e.substr(0,e.length-1)},t}();t.Http=e,__reflect(e.prototype,"LC.Http")}(LC||(LC={}));var LC;!function(t){var e=function(e){function n(){var t=null!==e&&e.apply(this,arguments)||this;return t._connectInterval=4500,t._headSize=12,t}return __extends(n,e),Object.defineProperty(n,"Instance",{get:function(){return this.getInstance()},enumerable:!0,configurable:!0}),n.prototype._initWebSocket=function(){this._socket=new egret.WebSocket,this._socket.type=egret.WebSocket.TYPE_BINARY,this._socket.addEventListener(egret.Event.CONNECT,this._onSocketOpen,this),this._socket.addEventListener(egret.ProgressEvent.SOCKET_DATA,this._onReceiveMessage,this),this._socket.addEventListener(egret.Event.CLOSE,this._onSocketClose,this),this._socket.addEventListener(egret.IOErrorEvent.IO_ERROR,this._onSocketError,this)},n.prototype.startConnect=function(t,e,n,r,i){egret.log("start connect "+t),this._successCallback=e,this._errorCallback=i,this._funcObj=n,this._initWebSocket(),this._socket.connectByUrl(t),this._timerId=egret.setTimeout(this.timeOutHandler,this,this._connectInterval)},n.prototype.closeSocket=function(){egret.clearTimeout(this._timerId),this._socket.removeEventListener(egret.Event.CONNECT,this._onSocketOpen,this),this._socket.removeEventListener(egret.Event.CLOSE,this._onSocketClose,this),this._socket.removeEventListener(egret.IOErrorEvent.IO_ERROR,this._onSocketError,this),this._socket.removeEventListener(egret.ProgressEvent.SOCKET_DATA,this._onReceiveMessage,this),this._socket.connected&&this._socket.close()},n.prototype.sendData=function(t,e,n){if(this._socket&&this._socket.connected){console.log("Send: mainID = "+t+" data = "+e);var r=this._EnvelopedMessage(e,t,n);r.endian=egret.Endian.LITTLE_ENDIAN,r.position=0,this._socket.writeBytes(r,0,r.length)}else egret.log("socket is not connected")},n.prototype.isConnected=function(){return this._socket&&this._socket.connected?!0:!1},n.prototype.timeOutHandler=function(){this._socket.connected||(egret.log("connect time out!"),this.closeSocket())},n.prototype._onSocketOpen=function(t){egret.log("connect successed"),egret.clearTimeout(this._timerId),this._successCallback&&this._successCallback.call(this._funcObj)},n.prototype._onSocketClose=function(t){egret.log("onSocketClose"),this._closeCallback&&this._closeCallback.call(this._funcObj)},n.prototype._onSocketError=function(t){egret.log("_onSocketError"),this._errorCallback&&this._errorCallback.call(this._funcObj)},n.prototype._onReceiveMessage=function(t){var e=new egret.ByteArray;this._socket.readBytes(e),this._parseMessage(e)},n.prototype._parseMessage=function(e){e.endian=egret.Endian.LITTLE_ENDIAN;var n=e.readInt(),r=e.readInt(),i=(e.readInt(),new egret.ByteArray);e.readBytes(i,0,n-this._headSize);var o=CryptoUtils.AESDecrypt(i,t.AESKEY);console.log("Receive: mainID = "+r+" data = "+o),t.EventManager.getInstance().dispatchCustomEvent(r.toString(),o)},n.prototype._EnvelopedMessage=function(e,n,r){void 0===r&&(r=0);var i=CryptoUtils.AESEncrypt(e,t.AESKEY),o=new egret.ByteArray;o.endian=egret.Endian.LITTLE_ENDIAN;for(var s=0;s<i.length;s++)o.writeByte(i[s]);var a=new egret.ByteArray;a.endian=egret.Endian.LITTLE_ENDIAN;var c=this._headSize+o.length;return a.writeInt(c),a.writeInt(n),a.writeInt(r),a.writeBytes(o,0,c),a},n}(t.Single);t.Socket=e,__reflect(e.prototype,"LC.Socket")}(LC||(LC={}));var LC;!function(t){var e;!function(t){t[t.Down=0]="Down",t[t.Right=1]="Right",t[t.Up=2]="Up",t[t.Left=3]="Left"}(e=t.Directions||(t.Directions={}));var n;!function(t){t[t.stand_down=0]="stand_down",t[t.stand_right=1]="stand_right",t[t.stand_up=2]="stand_up",t[t.stand_left=3]="stand_left",t[t.fall_down=4]="fall_down",t[t.fall_right=5]="fall_right",t[t.fall_up=6]="fall_up",t[t.fall_left=7]="fall_left",t[t.hide_v=8]="hide_v",t[t.hide_h=9]="hide_h"}(n||(n={}));var r;!function(t){t[t.Stand=0]="Stand",t[t.Fall=1]="Fall",t[t.Hide=2]="Hide"}(r=t.CardState||(t.CardState={}));var i=function(e){function r(){var t=e.call(this)||this;return t.skinName="Skin.Card",t}return __extends(r,e),r.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this)},r.prototype.setCardTexture=function(t,e,n){this.direction=t,this.value=n,this._setCardSkinState(t,e);var r=RES.getRes(this._getValueImageURL(t,e,n));this.fallRight.source=r,this.fallLeft.source=r,this.fallUp.source=r,this.fallDown.source=r,this.standDown.source=r},r.prototype._getValueImageURL=function(e,n,r){return n==t.CardState.Fall?"cards_json.card_small_"+r:"cards_json.card_big_"+r},Object.defineProperty(r.prototype,"Source",{set:function(t){this.value=t;var e=RES.getRes(this._getValueImageURL(this.direction,n[this.currentState],t));this.fallRight.source=e,this.fallLeft.source=e,this.fallUp.source=e,this.fallDown.source=e,this.standDown.source=e},enumerable:!0,configurable:!0}),r.prototype._setCardSkinState=function(e,r){var i;switch(r){case t.CardState.Stand:i=n.stand_down+e,this.currentState=n[i];break;case t.CardState.Fall:i=n.fall_down+e,this.currentState=n[i];break;case t.CardState.Hide:e==t.Directions.Up||e==t.Directions.Down?this.currentState=n[n.hide_v]:(e==t.Directions.Left||e==t.Directions.Right)&&(this.currentState=n[n.hide_h])}},r}(eui.Component);t.Card=i,__reflect(i.prototype,"LC.Card")}(LC||(LC={}));var LC;!function(t){var e;!function(t){t[t.Up=0]="Up",t[t.Down=1]="Down"}(e||(e={})),t.SelectCardComplete="selectCardComplete";var n=function(n){function r(){var t=n.call(this)||this;return t._handCardList=[],t._upDist=40,t.canOutACard=!1,t.skinName="Skin.CardModLayout",t}return __extends(r,n),r.prototype.childrenCreated=function(){n.prototype.childrenCreated.call(this)},r.prototype.initHandCards=function(e,n){this.currentState=t.Directions[e],ArrayUtils.sortByAsc(n),this._handCardList=n,this.HandCards.removeChildren();for(var r=0;r<n.length;r++){var i=this._createHandCard(e,n[r],t.CardState.Stand);this.HandCards.addChild(i)}},r.prototype.appliqueCards=function(e,n,r){if(e==t.Directions.Down){this._handCardList=this._deleteHuaCard(this._handCardList);for(var i in r)this._handCardList.push(r[i]);this.initHandCards(e,this._handCardList)}},r.prototype.buGang=function(e,n){for(var r=0;r<this.AllCards.numChildren;r++){var i=this.AllCards.getChildAt(r);i instanceof t.ComboCards&&i.changBuGang(e,n)}},r.prototype.fallDownAllHandCards=function(e,n){ArrayUtils.sortByAsc(n),this._handCardList=n,this.HandCards.removeChildren();for(var r=0;r<n.length;r++){var i=this._createHandCard(e,n[r],t.CardState.Fall);this.FallHandCards.addChild(i)}if(this._drawCardContainer){var o=this._drawCardContainer.getChildAt(0).value;this.addDrawCard(e,o,t.CardState.Fall)}},r.prototype._deleteHuaCard=function(t){var e=[];for(var n in t)(t[n]<97||t[n]>104)&&e.push(t[n]);return e},r.prototype.outACard=function(t,e,n){this._deleteAllHandCardsByValue(t,e);var r=this._addOutCard(t,e,n);return r},r.prototype._deleteAllHandCardsByValue=function(n,r){if(n==t.Directions.Down)if(this._upCardContainer&&this._upOrDown(this._upCardContainer,e.Down),this._drawCardContainer){var i=this._drawCardContainer.getChildAt(0).value;i==r?this.removeDrawCard():(this._deleteHandCardByValue(n,r),this._moveDrawCardToHandList(i))}else this._deleteHandCardByValue(n,r);else this._drawCardContainer?this.removeDrawCard():this._deleteHandCardByValue(n,r)},r.prototype._deleteHandCardByValue=function(e,n){if(e!=t.Directions.Down){var r=this.HandCards.getChildAt(0);r.parent.removeChild(r)}else{var i=this._handCardList.indexOf(n);if(-1==i)return;var r=this.HandCards.getChildAt(i);r.parent.removeChild(r),this._handCardList.splice(i,1)}},r.prototype._getInsertIndex=function(t){this._handCardList.push(t),ArrayUtils.sortByAsc(this._handCardList);var e=this._handCardList.indexOf(t);return e},r.prototype._moveDrawCardToHandList=function(t){var e=this._getInsertIndex(t),n=this._drawCardContainer.parent.removeChild(this._drawCardContainer);this.HandCards.addChildAt(n,e),this._drawCardContainer=null},r.prototype.moveCardToDrawCard=function(e,n){this._drawCardContainer||(this._deleteHandCardByValue(e,n),this.addDrawCard(e,n,t.CardState.Stand))},r.prototype.addDrawCard=function(t,n,r){this._upCardContainer&&this._upOrDown(this._upCardContainer,e.Down),this._drawCardContainer&&this._drawCardContainer.parent.removeChild(this._drawCardContainer),this._drawCardContainer=this._createHandCard(t,n,r),this.AllCards.addChild(this._drawCardContainer)},r.prototype.removeDrawCard=function(){this._drawCardContainer.parent.removeChild(this._drawCardContainer),this._drawCardContainer=null},r.prototype._addOutCard=function(e,n,r){var i=new eui.Group;this.OutCards.addChild(i);var o=new t.Card;return o.setCardTexture(e,t.CardState.Fall,n),o.anchorOffsetX=o.width/2,o.anchorOffsetY=o.height/2,o.horizontalCenter=0,o.verticalCenter=0,i.addChild(o),this._adjustOutDir(e,o),r&&this._moveCardPointer(i,r),i},r.prototype._moveCardPointer=function(t,e){e.parent&&e.parent.removeChild(e),e.y=t.getChildAt(0).y,e.visible=!0,t.addChild(e)},r.prototype._adjustOutDir=function(e,n){switch(e){case t.Directions.Left:n.scaleX=-1,n.anchorOffsetX=n.width/2,n.anchorOffsetY=n.height/2,n.horizontalCenter=0,n.verticalCenter=0;break;case t.Directions.Right:break;case t.Directions.Up:n.scaleX=n.scaleY=-.9;break;case t.Directions.Down:n.scaleX=n.scaleY=.9}},r.prototype.addCombToAllCardList=function(t,e,n,r){for(var i=0,o=e;i<o.length;i++){var s=o[i];this._deleteAllHandCardsByValue(t,s)}this._addComboCards(t,n,r)},r.prototype._createHandCard=function(e,n,r){var i=new eui.Group;i.y=0,e==t.Directions.Down&&r==t.CardState.Stand&&i.addEventListener(egret.TouchEvent.TOUCH_TAP,this._handCardHandler,this);var o=new t.Card;return o.setCardTexture(e,r,n),i.addChild(o),e==t.Directions.Down&&r==t.CardState.Fall?o.scaleX=o.scaleY=1.28:e==t.Directions.Down&&r==t.CardState.Stand&&(o.scaleX=o.scaleY=.85),i},r.prototype._handCardHandler=function(n){var r=n.currentTarget,i=this.HandCards.getChildIndex(r);if(console.log("inner Cards index = "+i+" click"),this._upCardContainer!=r)this._upCardContainer&&this._upOrDown(this._upCardContainer,e.Down),this._upOrDown(r,e.Up);else if(this._upCardContainer==r&&this.canOutACard){var o=this._upCardContainer.getChildAt(0);this.canOutACard=!1,t.EventManager.getInstance().dispatchCustomEvent(t.SelectCardComplete,{cardValue:o.value})}},r.prototype._upOrDown=function(t,n){n==e.Up?(t.getChildAt(0).y=-this._upDist,this._upCardContainer=t):n==e.Down&&(t.getChildAt(0).y=0,this._upCardContainer=null)},r.prototype._addComboCards=function(e,n,r){var i=new t.ComboCards;i.bottom=0,i.setCombCardsTexture(e,n,r),this.AllCards.addChildAt(i,0)},r.prototype.reSetMod=function(){this._handCardList=[],this._upCardContainer=null,this._drawCardContainer=null,this.canOutACard=!1;for(var t=[],e=0;e<this.AllCards.numChildren;e++){var n=this.AllCards.getChildAt(e);n!=this.HandCards&&n!=this.FallHandCards&&t.push(n)}for(var r=0,i=t;r<i.length;r++){var n=i[r];n.parent.removeChild(n)}this.FallHandCards.removeChildren(),this.HandCards.removeChildren(),this.OutCards.removeChildren()},r}(eui.Component);t.CardModLayout=n,__reflect(n.prototype,"LC.CardModLayout")}(LC||(LC={}));var LC;!function(t){var e;!function(t){t[t.Horizental=0]="Horizental",t[t.Vertical=1]="Vertical"}(e||(e={}));var n;!function(t){t[t.Chi=0]="Chi",t[t.Peng=1]="Peng",t[t.MGang=2]="MGang",t[t.AnGang=3]="AnGang"}(n=t.CardCombType||(t.CardCombType={}));var r=function(r){function i(){var t=r.call(this)||this;return t.skinName="Skin.ComboCards",t}return __extends(i,r),i.prototype.childrenCreated=function(){r.prototype.childrenCreated.call(this)},i.prototype.setCombCardsTexture=function(e,r,i){switch(this._setComboSkinState(e),e==t.Directions.Down&&(this.scaleX=this.scaleY=1.28),i){case n.Chi:case n.Peng:this._setChiOrPeng(e,r);break;case n.MGang:this._setMGang(e,r);break;case n.AnGang:this._setAnGang(e,r)}},i.prototype._isPengComb=function(t){for(var e=0;3>e;e++)if(this["cardH_"+e].value!=t||this["cardV_"+e].value!=t)return!1;return!0},i.prototype.changBuGang=function(e,n){this._isPengComb(n)&&(this.cardH_3.visible=!0,this.cardV_3.visible=!0,this.cardH_3.setCardTexture(e,t.CardState.Fall,n),this.cardV_3.setCardTexture(e,t.CardState.Fall,n))},i.prototype._setChiOrPeng=function(e,n){console.assert(3==n.length,"ChiOrPeng card number error !"),this.cardH_3.visible=!1,this.cardV_3.visible=!1,this._setList(e,t.CardState.Fall,n)},i.prototype._setMGang=function(e,n){console.assert(4==n.length,"MGang card number error !"),this._setList(e,t.CardState.Fall,n)},i.prototype._setAnGang=function(e,n){console.assert(4==n.length,"AnGang card number error !"),this._setList(e,t.CardState.Hide,n),e==t.Directions.Down&&this.cardH_3.setCardTexture(e,t.CardState.Fall,n[3])},i.prototype._setList=function(t,e,n){for(var r=0;r<n.length;r++)this["cardH_"+r].setCardTexture(t,e,n[r]),this["cardV_"+r].setCardTexture(t,e,n[r])},i.prototype._setComboSkinState=function(n){n==t.Directions.Up||n==t.Directions.Down?this.currentState=e[e.Horizental]:(n==t.Directions.Left||n==t.Directions.Right)&&(this.currentState=e[e.Vertical])},i}(eui.Component);t.ComboCards=r,__reflect(r.prototype,"LC.ComboCards")}(LC||(LC={}));var LC;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.skinName="Skins.LCButton",e}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.labelImage.text=this.label},e}(eui.Button);t.LCButton=e,__reflect(e.prototype,"LC.LCButton")}(LC||(LC={}));var LC;!function(t){var e=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.measure=function(){t.prototype.measure.call(this)},e.prototype.updateDisplayList=function(e,n){if(t.prototype.updateDisplayList.call(this,e,n),null!=this.target){for(var r=this.target.numElements,i=new Array,o=0;r>o;o++){var s=this.target.getElementAt(o);i.push(s)}r=i.length;for(var o=1;r>=o;o++){var a=i[o-1].width,c=i[o-1].height-10,d=r-o;console.log(d);var h=e-d%6*a,l=n-Math.floor(d/6)*c;i[o-1].x=h,i[o-1].y=l}}},e}(eui.LayoutBase);t.OutCardLayout=e,__reflect(e.prototype,"LC.OutCardLayout")}(LC||(LC={}));var LC;!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),Object.defineProperty(e,"Instance",{get:function(){return this.getInstance()},enumerable:!0,configurable:!0}),e.prototype.setLayer=function(t){this._layer=t,this._pool=[],this._queue=[]},e.show=function(t){e.Instance._initView(t)},e.prototype._initView=function(t){var e=this,r=this._pool.length>0?this._pool.pop():new n;r.text=t,r.alpha=0,r.x=this._layer.stage.stageHeight/2;var i=this._layer.stage.stageHeight/2-200;r.y=i,r.scaleX=r.scaleY=1.2,this._layer.addChild(r);var o=this._pool.length>0?1500:0;this._queue.push(1),egret.Tween.get(r).wait(o).to({y:i-100,alpha:1,scaleX:1,scaleY:1},500,egret.Ease.quadOut).wait(1500).to({y:i-180,alpha:0},500,egret.Ease.quadIn).call(function(t){e._layer.removeChild(t),e._pool.push(t),e._queue.pop()},this,[r])},e}(t.Single);t.Tips=e,__reflect(e.prototype,"LC.Tips");var n=function(t){function e(){var e=t.call(this)||this;return e._init(),e}return __extends(e,t),e.prototype._init=function(){this.width=.6*egret.MainContext.instance.stage.width,this._txt=new egret.TextField,this._txt.size=26,this._txt.bold=!0,this._txt.textColor=16777215,this._txt.multiline=!0,this._txt.wordWrap=!0,this._txt.textAlign=egret.HorizontalAlign.CENTER,this._txt.width=.5*egret.MainContext.instance.stage.width,this._txt.y=10,this.addChild(this._txt)},Object.defineProperty(e.prototype,"text",{set:function(t){this._txt.text=t,this.anchorOffsetX=this.width/2,this.anchorOffsetY=this.height/2,this.graphics.clear(),this.graphics.beginFill(0,.8),this.graphics.drawRoundRect(0,0,this._txt.width,this.height+20,30,30),this._txt.x=(this.width-this._txt.width)/2},enumerable:!0,configurable:!0}),e}(egret.Sprite);__reflect(n.prototype,"TipItem")}(LC||(LC={}));var LC;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.bg=new egret.Sprite,e}return __extends(e,t),e.prototype.init=function(){t.prototype.init.call(this),this.width=egret.MainContext.instance.stage.stageWidth,this.height=egret.MainContext.instance.stage.stageHeight,this.bg.graphics.clear(),this.bg.graphics.beginFill(0,.3),this.bg.graphics.drawRect(0,0,this.width,this.height),this.bg.graphics.endFill(),this.addChild(this.bg),this.waitImg=new eui.Image,this.waitImg.source=RES.getRes("loadingCircle_png"),this.addChild(this.waitImg),this.waitImg.horizontalCenter=0,this.waitImg.verticalCenter=0,EffectUtils.rotationEffect(this.waitImg,1e3)},e}(t.Layer);__reflect(e.prototype,"Waiting");var n=function(n){function r(){var t=null!==n&&n.apply(this,arguments)||this;return t.waiting=new e,t}return __extends(r,n),Object.defineProperty(r,"Instance",{get:function(){return this.getInstance()},enumerable:!0,configurable:!0}),r.prototype.show=function(){null==this.waiting&&(this.waiting=new e),t.SceneManager.Instance.runningScene.addChild(this.waiting)},r.prototype.hide=function(){t.SceneManager.Instance.runningScene.contains(this.waiting)&&(t.SceneManager.Instance.runningScene.removeChild(this.waiting),this.waiting=null)},r}(t.Single);t.WaitingManager=n,__reflect(n.prototype,"LC.WaitingManager")}(LC||(LC={}));var ArrayUtils;!function(t){function e(t){t.sort(function(t,e){return t-e})}function n(t){var e=0;for(var n in t)e++;return e}function r(t,e){var n=t.indexOf(e);-1!=n&&t.splice(n,1)}function i(t){return[].concat(JSON.parse(JSON.stringify(t)))}function o(t){var e=Object.keys(t);return 0==e.length}t.sortByAsc=e,t.getObjectLength=n,t.deleteByValue=r,t.DeepCopy=i,t.isEmptyObject=o}(ArrayUtils||(ArrayUtils={}));var Base64=function(){function t(){this.PADCHAR="=",this.ALPHA="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"}return t.prototype.getByte=function(t,e){var n=t.charCodeAt(e);return n},t.prototype.getByte64=function(t,e){var n=this.ALPHA.indexOf(t.charAt(e));return n},t.prototype.decode=function(t){var e,n,r=0,i=t.length,o=[];if(t=String(t),0===i)return t;for(t.charAt(i-1)===this.PADCHAR&&(r=1,t.charAt(i-2)===this.PADCHAR&&(r=2),i-=4),e=0;i>e;e+=4)n=this.getByte64(t,e)<<18|this.getByte64(t,e+1)<<12|this.getByte64(t,e+2)<<6|this.getByte64(t,e+3),o.push(String.fromCharCode(n>>16,n>>8&255,255&n));switch(r){case 1:n=this.getByte64(t,e)<<18|this.getByte64(t,e+1)<<12|this.getByte64(t,e+2)<<6,o.push(String.fromCharCode(n>>16,n>>8&255));break;case 2:n=this.getByte64(t,e)<<18|this.getByte64(t,e+1)<<12,o.push(String.fromCharCode(n>>16))}return o.join("")},t.prototype.encode=function(t){t=String(t);var e,n,r=[],i=t.length-t.length%3;if(0===t.length)return t;for(e=0;i>e;e+=3)n=this.getByte(t,e)<<16|this.getByte(t,e+1)<<8|this.getByte(t,e+2),r.push(this.ALPHA.charAt(n>>18)),r.push(this.ALPHA.charAt(n>>12&63)),r.push(this.ALPHA.charAt(n>>6&63)),r.push(this.ALPHA.charAt(63&n));switch(t.length-i){case 1:n=this.getByte(t,e)<<16,r.push(this.ALPHA.charAt(n>>18)+this.ALPHA.charAt(n>>12&63)+this.PADCHAR+this.PADCHAR);break;case 2:n=this.getByte(t,e)<<16|this.getByte(t,e+1)<<8,r.push(this.ALPHA.charAt(n>>18)+this.ALPHA.charAt(n>>12&63)+this.ALPHA.charAt(n>>6&63)+this.PADCHAR)}return r.join("")},t}();__reflect(Base64.prototype,"Base64");var CryptoUtils;!function(t){function e(t,e){var n=r(t,e);return o(n)}function n(t,e){var n=a(String.fromCharCode.apply(null,new Uint8Array(t.buffer)));return console.log("AESDecrypt base64:",n),i(n,e)}function r(t,e){var n=CryptoJS.enc.Utf8.parse(e),r=CryptoJS.AES.encrypt(t,n,{mode:CryptoJS.mode.ECB,padding:CryptoJS.pad.Pkcs7}),i=r.toString();return i}function i(t,e){var n=CryptoJS.enc.Utf8.parse(e),r=CryptoJS.AES.decrypt(t,n,{mode:CryptoJS.mode.ECB,padding:CryptoJS.pad.Pkcs7}),i=r.toString(CryptoJS.enc.Utf8);return i}function o(t){for(var e=s(t),n=e.length,r=new Uint8Array(n),i=0;n>i;i++)r[i]=e.charCodeAt(i);return r}function s(t){return(new Base64).decode(t)
}function a(t){return(new Base64).encode(t)}t.AESEncrypt=e,t.AESDecrypt=n}(CryptoUtils||(CryptoUtils={}));var EffectUtils;!function(t){function e(t,e){if(void 0===e&&(e=1e3),null==this.rotationArr&&(this.rotationArr=[]),!this.rotationArr[t.hashCode]){null!=this.rotationArr[t.hashCode]&&this.rotationArr[t.hashCode]||(this.rotationArr[t.hashCode]=!0);var n=function(){t.rotation=0,egret.Tween.get(t).to({rotation:360},e).call(n,this)};t.rotation=0,egret.Tween.get(t).to({rotation:360},e).call(n,this)}}function n(t){null==this.rotationArr&&(this.rotationArr=[]),this.rotationArr[t.hashCode]=!1}t.rotationEffect=e,t.removeRotationEffect=n}(EffectUtils||(EffectUtils={}));var LC;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e._groups={},RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,e._onResourceLoadComplete,e),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,e._onResourceLoadProgress,e),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,e._onResourceLoadError,e),e}return __extends(e,t),Object.defineProperty(e,"Instance",{get:function(){return this.getInstance()},enumerable:!0,configurable:!0}),e.prototype.loadGroup=function(t,e,n,r,i){var o=this._combGroupName(t);this._groups[o]=[n,r,e],RES.loadGroup(o)},e.prototype._combGroupName=function(t){if("string"==typeof t)return t;for(var e=t.length,n="",r=0;e>r;r++)n+=t[r];return RES.createGroup(n,t,!1),n},e.prototype._onResourceLoadComplete=function(t){var e=t.groupName;if(console.log("资源组加载完成:"+e),this._groups[e]){var n=this._groups[e][0],r=this._groups[e][2];null!=n&&n.call(r,t),this._groups[e]=null,delete this._groups[e]}},e.prototype._onResourceLoadProgress=function(t){var e=t.groupName;if(this._groups[e]){var n=this._groups[e][1],r=this._groups[e][2];null!=n&&n.call(r,t)}},e.prototype._onResourceLoadError=function(t){console.error(t.groupName+"资源组有资源加载失败"),this._onResourceLoadComplete(t)},e}(t.Single);t.ResUtil=e,__reflect(e.prototype,"LC.ResUtil")}(LC||(LC={}));var AssetAdapter=function(){function t(){}return t.prototype.getAsset=function(t,e,n){function r(r){e.call(n,r,t)}if(RES.hasRes(t)){var i=RES.getRes(t);i?r(i):RES.getResAsync(t,r,this)}else RES.getResByUrl(t,r,this,RES.ResourceItem.TYPE_IMAGE)},t}();__reflect(AssetAdapter.prototype,"AssetAdapter",["eui.IAssetAdapter"]);var LC;!function(t){var e=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return __extends(n,e),n.prototype.init=function(){e.prototype.init.call(this),this.SocketEventList=[t.SocketEvents.Send100100,t.SocketEvents.Rev101107,t.SocketEvents.Rev101106,t.SocketEvents.Rev101004,t.SocketEvents.Rev101005,t.SocketEvents.Rev101008,t.SocketEvents.Rev101007,t.SocketEvents.Rev101002,t.SocketEvents.Rev101001,t.SocketEvents.Rev101112,t.SocketEvents.Send100140,t.SocketEvents.Send100999,t.SocketEvents.Rev101006,t.SocketEvents.Rev101003,t.SocketEvents.Rev101110,t.SocketEvents.Rev101109,t.SocketEvents.Send100103]},n.prototype.onMySelfReady=function(e){var n={};n.user_id=t.UsersInfo.MySelf.user_id,n.ready=e,t.Socket.Instance.sendData(t.SocketEvents.Send100100,JSON.stringify(n))},n.prototype.actChuCard=function(e){var n={};n.user_id=t.UsersInfo.MySelf.user_id,n.act=t.ACT.CHU;var r={};r.card=e;var i=JSON.stringify(r);n.act_params=i,t.Socket.Instance.sendData(t.SocketEvents.Send100140,JSON.stringify(n))},n.prototype.exitRoom=function(){var e={};e.user_id=t.UsersInfo.MySelf.user_id,t.Socket.Instance.sendData(t.SocketEvents.Send100103,JSON.stringify(e))},n.prototype.test_Send=function(e,n,r){void 0===r&&(r=[]);var i={};i.user_id=t.UsersInfo.MySelf.user_id,i.test_type=e;var o={};o.source_card=r,o.target_card=n;var s=JSON.stringify(o);i.test_params=s,t.Socket.Instance.sendData(t.SocketEvents.Send100999,JSON.stringify(i))},n.prototype.on_100100_event=function(e){console.log(this.TAG+" on_100100_event: "+e.data);var n=e.data,r=JSON.parse(n);if(200==r.code)r.info.ready==t.ReadyState.GetReady?(console.log("准备成功"),t.UsersInfo.MySelf.status=t.UserState.READY,this._isAllUsersReady()):r.info.ready==t.ReadyState.Cancel&&(t.UsersInfo.MySelf.status=t.UserState.UNREADY);else{var i=JSON.parse(n);t.Tips.show(t.ErrorCodeManager.Instance.getErrorCode(i.code))}},n.prototype.on_101107_event=function(e){console.log(this.TAG+" on_101107_event: "+e.data);var n=e.data,r=JSON.parse(n);if(200==r.code){console.log("玩家id为"+r.info.user_id+"进入房间");var i=new t.User;for(var o in r.info)i[o]=r.info[o];t.UsersInfo.Instance.addUser(i),t.EventManager.getInstance().dispatchCustomEvent(CustomEvents.OtherPlayer_EnterROOM,{user:i})}else{var s=JSON.parse(n);t.Tips.show(t.ErrorCodeManager.Instance.getErrorCode(s.code))}},n.prototype.on_100103_event=function(e){console.log(this.TAG+" on_101107_event: "+e.data);var n=e.data,r=JSON.parse(n);if(200==r.code)console.log("玩家id为"+r.info.user_id+"进入房间");else{var i=JSON.parse(n);t.Tips.show(t.ErrorCodeManager.Instance.getErrorCode(i.code))}},n.prototype.on_101110_event=function(e){console.log(this.TAG+" on_101110_event: "+e.data);var n=e.data,r=JSON.parse(n);if(200==r.code){console.log("玩家id为"+r.info.user_id+"当前状态为"+t.NetState[r.info.is_online]);var i=t.UsersInfo.Instance.getUserById(r.info.user_id);i.is_online=r.info.is_online}else{var o=JSON.parse(n);t.Tips.show(t.ErrorCodeManager.Instance.getErrorCode(o.code))}},n.prototype.on_101109_event=function(e){console.log(this.TAG+" on_101109_event: "+e.data);var n=e.data,r=JSON.parse(n);if(200==r.code){console.log("玩家id为"+r.info.user_id+"断线重连成功");var i=t.UsersInfo.Instance.getUserById(r.info.user_id);i.is_online=t.NetState.ONLINE}else{var o=JSON.parse(n);t.Tips.show(t.ErrorCodeManager.Instance.getErrorCode(o.code))}},n.prototype.on_101106_event=function(e){console.log(this.TAG+" on_101106_event: "+e.data);var n=e.data,r=JSON.parse(n);if(200==r.code){var i=t.UsersInfo.Instance.getUserById(r.info.user_id);r.info.ready==t.ReadyState.GetReady?(console.log("玩家id为"+r.info.user_id+"进入准备状态"),i.status=t.UserState.READY,this._isAllUsersReady()):r.info.ready==t.ReadyState.Cancel&&(console.log("玩家id为"+r.info.user_id+"取消准备"),i.status=t.UserState.UNREADY)}else{var o=JSON.parse(n);t.Tips.show(t.ErrorCodeManager.Instance.getErrorCode(o.code))}},n.prototype._isAllUsersReady=function(){t.UsersInfo.Instance.isAllUsersReady()&&(t.DeskInfo.diceValue=[-1,-1],t.EventManager.getInstance().dispatchCustomEvent(CustomEvents.AllUsersReady))},n.prototype.on_101004_event=function(e){console.log(this.TAG+" on_101004_event: "+e.data);var n=e.data,r=JSON.parse(n);if(200==r.code){var i=r.info.bank_seat_id,o=t.UsersInfo.Instance.getUserBySeatID(i);console.log("客户端座位为"+o.client_seatID+"是庄家"),o.isBanker=!0,t.DeskInfo.diceValue=r.info.dice}else{var s=JSON.parse(n);t.Tips.show(t.ErrorCodeManager.Instance.getErrorCode(s.code))}},n.prototype.on_101005_event=function(e){console.log(this.TAG+" on_101005_event: "+e.data);var n=e.data,r=JSON.parse(n);if(200==r.code)t.EventManager.getInstance().dispatchCustomEvent(CustomEvents.DealCard,{all_cards:r.info.all_cards});else{var i=JSON.parse(n);t.Tips.show(t.ErrorCodeManager.Instance.getErrorCode(i.code))}},n.prototype.on_101008_event=function(e){console.log(this.TAG+" on_101008_event: "+e.data);var n=e.data,r=JSON.parse(n);if(200==r.code)t.EventManager.getInstance().dispatchCustomEvent(CustomEvents.BuHua_DealCard,{info:r.info});else{var i=JSON.parse(n);t.Tips.show(t.ErrorCodeManager.Instance.getErrorCode(i.code))}},n.prototype.on_101002_event=function(e){console.log(this.TAG+" on_101002_event: "+e.data);var n=e.data,r=JSON.parse(n);if(200==r.code)t.DeskInfo.remain_count=r.info.remain_count,t.EventManager.getInstance().dispatchCustomEvent(CustomEvents.DrawCard,{info:r.info});else{var i=JSON.parse(n);t.Tips.show(t.ErrorCodeManager.Instance.getErrorCode(i.code))}},n.prototype.on_101007_event=function(e){console.log(this.TAG+" on_101007_event: "+e.data);var n=e.data,r=JSON.parse(n);if(200==r.code)t.EventManager.getInstance().dispatchCustomEvent(CustomEvents.BuHua_GameCard,{info:r.info});else{var i=JSON.parse(n);t.Tips.show(t.ErrorCodeManager.Instance.getErrorCode(i.code))}},n.prototype.on_101001_event=function(e){console.log(this.TAG+" on_101001_event: "+e.data);var n=e.data,r=JSON.parse(n);if(200==r.code)t.EventManager.getInstance().dispatchCustomEvent(CustomEvents.CanAct,{info:r.info});else{var i=JSON.parse(n);t.Tips.show(t.ErrorCodeManager.Instance.getErrorCode(i.code))}},n.prototype.on_100140_event=function(t){console.log(this.TAG+" on_101001_event: "+t.data);t.data},n.prototype.on_101112_event=function(e){console.log(this.TAG+" on_101112_event: "+e.data);var n=e.data,r=JSON.parse(n);if(200==r.code)t.EventManager.getInstance().dispatchCustomEvent(CustomEvents.ACT_Aleady,{info:r.info});else{var i=JSON.parse(n);t.Tips.show(t.ErrorCodeManager.Instance.getErrorCode(i.code))}},n.prototype.on_101006_event=function(e){console.log(this.TAG+" on_101006_event: "+e.data);var n=e.data,r=JSON.parse(n);if(200==r.code)t.EventManager.getInstance().dispatchCustomEvent(CustomEvents.CheckOut,{info:r.info});else{var i=JSON.parse(n);t.Tips.show(t.ErrorCodeManager.Instance.getErrorCode(i.code))}},n.prototype.on_101003_event=function(e){console.log(this.TAG+" on_101003_event: "+e.data);var n=e.data,r=JSON.parse(n);if(200==r.code)t.EventManager.getInstance().dispatchCustomEvent(CustomEvents.GameOver,{info:r.info});else{var i=JSON.parse(n);t.Tips.show(t.ErrorCodeManager.Instance.getErrorCode(i.code))}},n.prototype.on_100999_event=function(e){console.log(this.TAG+" on_100999_event: "+e.data);var n=e.data,r=JSON.parse(n);if(200==r.code)switch(r.info.test_type){case t.TestType.DealCard:break;case t.TestType.ChangeCard:t.EventManager.getInstance().dispatchCustomEvent(CustomEvents.ChangeCard,{info:r.info})}else{var i=JSON.parse(n);t.Tips.show(t.ErrorCodeManager.Instance.getErrorCode(i.code))}},n}(t.Controller);t.GameLayerController=e,__reflect(e.prototype,"LC.GameLayerController")}(LC||(LC={}));var LC;!function(t){var e=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return __extends(n,e),n.prototype.init=function(){e.prototype.init.call(this),this.SocketEventList=[]},n.prototype.actGuo=function(){var e={};this._sendData(t.ACT.GUO,e)},n.prototype.actChi=function(e){var n={};n.used_card=e,this._sendData(t.ACT.CHI,n)},n.prototype.actPeng=function(){var e={};this._sendData(t.ACT.PENG,e)},n.prototype.actGang=function(t,e){var n={};e&&(n.used_card=e),this._sendData(t,n)},n.prototype.actHu=function(t){var e={};this._sendData(t,e)},n.prototype._sendData=function(e,n){var r={};r.user_id=t.UsersInfo.MySelf.user_id,r.act=e;var i=JSON.stringify(n);r.act_params=i,t.Socket.Instance.sendData(t.SocketEvents.Send100140,JSON.stringify(r))},n}(t.Controller);t.ActHandlerController=e,__reflect(e.prototype,"LC.ActHandlerController")}(LC||(LC={}));var LC;!function(t){var e=function(e){function n(){return e.call(this)||this}return __extends(n,e),n.prototype.init=function(){e.prototype.init.call(this),this.SocketEventList=[t.SocketEvents.Send100002,t.SocketEvents.Send100010]},n.prototype.on_100002_event=function(e){console.log(this.TAG+" on_100002_event: ");var n=e.data,r=JSON.parse(n);if(200==r.code){if(console.log("登录游戏服务器成功"),""!=r.info.room){console.log("需要断线重连");var i={};i.user_id=t.UsersInfo.MySelf.user_id,t.Socket.Instance.sendData(t.SocketEvents.Send100010,JSON.stringify(i))}}else{var o=JSON.parse(n);t.Tips.show(t.ErrorCodeManager.Instance.getErrorCode(o.code))}},n.prototype.on_100010_event=function(e){console.log(this.TAG+" on_100010_event: ");var n=e.data,r=JSON.parse(n);if(200==r.code){console.log("断线重连成功"),t.Config.MaxPlayerCount=r.info.desk_info.max_player_num,t.DeskInfo.deskID=r.info.desk_info.desk_id,t.DeskInfo.gameData=r.info.game_data,t.DeskInfo.status=r.info.desk_info.status,t.UsersInfo.Instance.addManyUsers(r.info.desk_info.users);var i=new t.GameScene;t.SceneManager.Instance.replaceScene(i)}else{var o=JSON.parse(n);t.Tips.show(t.ErrorCodeManager.Instance.getErrorCode(o.code))}},n.prototype.connectSocket=function(){t.Socket.Instance.startConnect(t.Config.SERVER_URL,this._onSocketConnect,this,this._onSocketClose)},n.prototype._onSocketConnect=function(){this._wServerLogin(),this.timer=egret.setInterval(this._sentHeart,this,18e5)},n.prototype._onSocketClose=function(){console.log(this.TAG+" onSocketClose"),egret.clearInterval(this.timer)},n.prototype._sentHeart=function(){console.log("发送心跳"),t.Socket.Instance.sendData(t.SocketEvents.Send100000,"")},n.prototype._wServerLogin=function(){var e={};e.passwd=t.Config.MD5PASS,e.user_id=t.UsersInfo.MySelf.user_id,t.Socket.Instance.sendData(t.SocketEvents.Send100002,JSON.stringify(e))},n}(t.Controller);t.HallLayerController=e,__reflect(e.prototype,"LC.HallLayerController")}(LC||(LC={}));var LC;!function(t){var e=function(e){function n(){return e.call(this)||this}return __extends(n,e),n.prototype.init=function(){e.prototype.init.call(this),this.SocketEventList=[t.SocketEvents.Rev100000]},n.prototype.on_100000_event=function(t){console.log(this.TAG+" on_100000_event: "+t.data)},n}(t.Controller);t.LoadingLayerController=e,__reflect(e.prototype,"LC.LoadingLayerController")}(LC||(LC={}));var LC;!function(t){var e=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return __extends(n,e),n.prototype.init=function(){e.prototype.init.call(this),this.SocketEventList=[]},n.prototype.sendDebugLoginReq=function(e,n){var r=(t.WEB_URL+"login",{user:e,password:n}),i=(JSON.stringify(r),JSON.stringify({action:"LoginHandler",data:{diamond:0,uid:e,avater_url:"https://impublic-res.oss-cn-shenzhen.aliyuncs.com/f5c7153f80aa66f7a4f2fd9e0d9b996b",ip:"192.168.1.101",sex:1,user:"test1",password:"8222b2020c704671b9c51d6fdcfe776c",port:2e4,accid:1,skey:"30d148f652bfdf660b873313f0acda73",name:"test1",point:0,payment:2,is_visitor:0},ret:0,desc:"success"})),o={currentTarget:{response:i}};this._loginResult(o)},n.prototype._loginResult=function(e){var n=e.currentTarget.response,r=JSON.parse(n);if(console.log("login success! data : ",r),"0"==r.ret){var i=r.data,o=new t.User;o.user_id=i.uid,t.UsersInfo.MySelf=o,t.Config.SERVER_URL="ws://"+i.ip+":"+i.port,t.Config.MD5PASS=i.password,this.gotoHall()}else console.log("login error action:%s,ret:%s,desc:%s",r.action,r.ret,r.desc)},n.prototype.gotoHall=function(){var e=new t.HallScene;t.SceneManager.Instance.replaceScene(e)},n}(t.Controller);t.LoginLayerController=e,__reflect(e.prototype,"LC.LoginLayerController")}(LC||(LC={}));var LC;!function(t){var e=function(e){function n(){return e.call(this)||this}return __extends(n,e),n.prototype.init=function(){e.prototype.init.call(this),this.SocketEventList=[t.SocketEvents.Send100102]},n.prototype.on_100102_event=function(e){console.log(this.TAG+" on_100102_event: ");var n=e.data,r=JSON.parse(n);if(200==r.code){console.log("加入好友房间成功"),t.DeskInfo.deskID=r.info.desk_id,t.UsersInfo.Instance.addManyUsers(r.info.seat_info);var i=new t.GameScene;t.SceneManager.Instance.replaceScene(i)}else{var o=JSON.parse(n);t.Tips.show(t.ErrorCodeManager.Instance.getErrorCode(o.code))}},n.prototype.joinFriendRoom=function(e){var n={};n.user_id=t.UsersInfo.MySelf.user_id,n.desk_id=e,t.Socket.Instance.sendData(t.SocketEvents.Send100102,JSON.stringify(n))},n}(t.Controller);t.JoinRoomController=e,__reflect(e.prototype,"LC.JoinRoomController")}(LC||(LC={}));var LC;!function(t){var e=function(e){function n(){return e.call(this)||this}return __extends(n,e),n.prototype.init=function(){e.prototype.init.call(this),this.SocketEventList=[t.SocketEvents.Send100101]},n.prototype.on_100101_event=function(e){console.log(this.TAG+" on_100101_event: ");var n=e.data,r=JSON.parse(n);if(200==r.code){console.log("创建好友房成功"),t.DeskInfo.deskID=r.info.desk_id;var i=new t.User;for(var o in r.info.seat_info[0])i[o]=r.info.seat_info[0][o];t.UsersInfo.MySelf=i,t.UsersInfo.Instance.addUser(t.UsersInfo.MySelf);var s=new t.GameScene;t.SceneManager.Instance.replaceScene(s)}else{var a=JSON.parse(n);t.Tips.show(a.info)}},n.prototype.createRoom=function(){var e={};e.user_id=t.UsersInfo.MySelf.user_id,t.Socket.Instance.sendData(t.SocketEvents.Send100101,JSON.stringify(e))},n}(t.Controller);t.SelectRoomController=e,__reflect(e.prototype,"LC.SelectRoomController")}(LC||(LC={}));var CustomEvents;!function(t){t.OtherPlayer_EnterROOM="otherPlayerEnterRoom",t.DealCard="dealCard",t.DrawCard="drawCard",t.BuHua_DealCard="buHuaDealCard",t.BuHua_GameCard="buHuaGameCard",t.AllUsersReady="allUsersReady",t.CanAct="canAct",t.ACT_Aleady="actAleady",t.ChangeCard="changeCard",t.CheckOut="checkOut",t.GameOver="gameOver"}(CustomEvents||(CustomEvents={}));var LC;!function(t){var e;!function(t){t[t.Send100000=1e5]="Send100000",t[t.Send100002=100002]="Send100002",t[t.Send100010=100010]="Send100010",t[t.Send100100=100100]="Send100100",t[t.Send100101=100101]="Send100101",t[t.Send100102=100102]="Send100102",t[t.Send100103=100103]="Send100103",t[t.Send100104=100104]="Send100104",t[t.Send100110=100110]="Send100110",t[t.Send100111=100111]="Send100111",t[t.Send100120=100120]="Send100120",t[t.Send100130=100130]="Send100130",t[t.Send100140=100140]="Send100140",t[t.Send100999=100999]="Send100999",t[t.Rev100000=1e5]="Rev100000",t[t.Rev100104=100104]="Rev100104",t[t.Rev100110=100110]="Rev100110",t[t.Rev100111=100111]="Rev100111",t[t.Rev100120=100120]="Rev100120",t[t.Rev100130=100130]="Rev100130",t[t.Rev101001=101001]="Rev101001",t[t.Rev101002=101002]="Rev101002",t[t.Rev101003=101003]="Rev101003",t[t.Rev101004=101004]="Rev101004",t[t.Rev101005=101005]="Rev101005",t[t.Rev101006=101006]="Rev101006",t[t.Rev101007=101007]="Rev101007",t[t.Rev101008=101008]="Rev101008",t[t.Rev101100=101100]="Rev101100",t[t.Rev101101=101101]="Rev101101",t[t.Rev101102=101102]="Rev101102",t[t.Rev101103=101103]="Rev101103",t[t.Rev101104=101104]="Rev101104",t[t.Rev101105=101105]="Rev101105",t[t.Rev101106=101106]="Rev101106",t[t.Rev101107=101107]="Rev101107",t[t.Rev101108=101108]="Rev101108",t[t.Rev101109=101109]="Rev101109",t[t.Rev101110=101110]="Rev101110",t[t.Rev101112=101112]="Rev101112",t[t.Send100112=100112]="Send100112"}(e=t.SocketEvents||(t.SocketEvents={}))}(LC||(LC={}));var LC;!function(t){var e=function(){function t(){}return t}();t.DeskInfo=e,__reflect(e.prototype,"LC.DeskInfo")}(LC||(LC={}));var LC;!function(t){var e=function(e){function n(){var t=null!==e&&e.apply(this,arguments)||this;return t._users={},t}return __extends(n,e),Object.defineProperty(n,"Instance",{get:function(){return this.getInstance()},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"UsersList",{get:function(){return this._users},enumerable:!0,configurable:!0}),n.prototype._setClientSeatID=function(e){e.user_id==n.MySelf.user_id&&(e.client_seatID=0,n.MySelf=e);var r=t.Config.MaxPlayerCount-n.MySelf.seat_id;e.client_seatID=(r+e.seat_id)%t.Config.MaxPlayerCount,console.log(e.user_id+"的客户端座位号为"+e.client_seatID)},n.prototype.addUser=function(t){this._users[t.user_id]=t,this._setClientSeatID(t)},n.prototype.addManyUsers=function(e){this._findAndSetMyself(e);for(var r=0,i=e;r<i.length;r++){var o=i[r],s=new t.User;for(var a in o)s[a]=o[a];n.Instance.addUser(s)}},n.prototype._findAndSetMyself=function(e){for(var r=0,i=e;r<i.length;r++){var o=i[r],s=new t.User;for(var a in o)s[a]=o[a];s.user_id==n.MySelf.user_id&&(n.MySelf=s)}},n.prototype.getUserById=function(t){return this._users[t]},n.prototype.getUserBySeatID=function(t){for(var e in this._users)if(this._users[e].seat_id==t)return this._users[e]},n.prototype.isAllUsersReady=function(){if(ArrayUtils.getObjectLength(this._users)!=t.Config.MaxPlayerCount)return!1;for(var e in this._users)if(this._users[e].status!=t.UserState.READY)return!1;return!0},n.prototype.deleteUser=function(t){delete this._users[t]},n.prototype.reSetAllUsersStatus=function(){for(var e in this._users)this._users[e].status=t.UserState.UNREADY},n.prototype.reSetAllUsersBanker=function(){for(var t in this._users)this._users[t].isBanker=!1},n}(t.Single);t.UsersInfo=e,__reflect(e.prototype,"LC.UsersInfo")}(LC||(LC={}));var LC;!function(t){var e;!function(t){t[t.Cancel=0]="Cancel",t[t.GetReady=1]="GetReady"}(e=t.ReadyState||(t.ReadyState={}));var n;!function(t){t[t.GUO=0]="GUO",t[t.CHU=10]="CHU",t[t.CHI=20]="CHI",t[t.PENG=30]="PENG",t[t.DIAN_GANG=40]="DIAN_GANG",t[t.BU_GANG=50]="BU_GANG",t[t.AN_GANG=60]="AN_GANG",t[t.TING=70]="TING",t[t.DIAN_HU=80]="DIAN_HU",t[t.ZI_MO=90]="ZI_MO"}(n=t.ACT||(t.ACT={}));var r;!function(t){t[t.ChangeCard=1]="ChangeCard",t[t.ConfirmNextCard=2]="ConfirmNextCard",t[t.checkLastCard=3]="checkLastCard",t[t.DealCard=4]="DealCard"}(r=t.TestType||(t.TestType={}));var i;!function(t){t[t.Hu=1]="Hu",t[t.Gang=2]="Gang",t[t.FollowBanker=3]="FollowBanker"}(i=t.CheckOutType||(t.CheckOutType={}));var o;!function(t){t[t.PI_HU=1e3]="PI_HU",t[t.PENG_PENG_HU=1001]="PENG_PENG_HU",t[t.QI_XIAO_DUI=2e3]="QI_XIAO_DUI",t[t.SHI_SAN_YAO=3e3]="SHI_SAN_YAO",t[t.QING_YI_SE=9001]="QING_YI_SE"}(o||(o={}));var s;!function(t){t[t.WAIT_SET=1]="WAIT_SET",t[t.WAIT_AGREE=2]="WAIT_AGREE",t[t.PLAYING=3]="PLAYING",t[t.OVER=4]="OVER"}(s=t.DeskStatus||(t.DeskStatus={}))}(LC||(LC={}));var LC;!function(t){var e;!function(t){t[t.UNREADY=1]="UNREADY",t[t.READY=2]="READY",t[t.PLAYING=3]="PLAYING",t[t.ESCAPE=4]="ESCAPE"}(e=t.UserState||(t.UserState={}));var n;!function(t){t[t.OFFLINE=0]="OFFLINE",t[t.ONLINE=1]="ONLINE"}(n=t.NetState||(t.NetState={}));var r=function(){function t(){this.nick="",this.isBanker=!1}return t}();t.User=r,__reflect(r.prototype,"LC.User")}(LC||(LC={}));var LC;!function(t){var e=function(e){function n(){return e.call(this)||this}return __extends(n,e),n.prototype.init=function(){e.prototype.init.call(this),this.gameLayer=new t.GameLayer,this.gameLayer.Ctrl=new t.GameLayerController,this.addChild(this.gameLayer)},n}(t.Scene);t.GameScene=e,__reflect(e.prototype,"LC.GameScene")}(LC||(LC={}));var LC;!function(t){var e=function(e){function n(){return e.call(this)||this}return __extends(n,e),n.prototype.init=function(){e.prototype.init.call(this);var n=new t.HallLayer;n.Ctrl=new t.HallLayerController,this.addChild(n)},n}(t.Scene);t.HallScene=e,__reflect(e.prototype,"LC.HallScene")}(LC||(LC={}));var LC;!function(t){var e=function(e){function n(){return e.call(this)||this}return __extends(n,e),n.prototype.init=function(){e.prototype.init.call(this),this.loadingView=new t.LoadingLayer,this.loadingView.Ctrl=new t.LoadingLayerController,this.addChild(this.loadingView)},n.prototype.unLoadAsset=function(){e.prototype.unLoadAsset.call(this),RES.destroyRes("loading")},n}(t.Scene);t.LoadingScene=e,__reflect(e.prototype,"LC.LoadingScene")}(LC||(LC={}));var LC;!function(t){var e=function(e){function n(){return e.call(this)||this}return __extends(n,e),n.prototype.init=function(){e.prototype.init.call(this),this.loginLayer=new t.LoginLayer,this.loginLayer.Ctrl=new t.LoginLayerController,this.addChild(this.loginLayer)},n}(t.Scene);t.LoginScene=e,__reflect(e.prototype,"LC.LoginScene")}(LC||(LC={}));var LC;!function(t){var e=function(e){function n(){var t=e.call(this)||this;return t.skinName="Skin.UserHead",t}return __extends(n,e),n.prototype._watchData=function(){eui.Binding.bindHandler(this._userModel,["user_id"],this._userNameChange,this),eui.Binding.bindHandler(this._userModel,["isBanker"],this._userIsBankerChange,this),eui.Binding.bindHandler(this._userModel,["status"],this._userIsReadyChange,this),eui.Binding.bindHandler(this._userModel,["is_online"],this._isOnlineChange,this)},n.prototype._userNameChange=function(t){null!=t&&(console.log("_userNameChange"),this.label_Name.text=t||"")},n.prototype._userIsBankerChange=function(t){null!=t&&(console.log("_userIsBankerChange"),this.img_banker.visible=t)},n.prototype._userIsReadyChange=function(e){null!=e&&(console.log("_userIsReadyChange"),this.label_ready.visible=e==t.UserState.READY?!0:!1)},n.prototype._isOnlineChange=function(e){null!=e&&(console.log("_isOnlineChange"),this.off_line.visible=e==t.NetState.OFFLINE?!0:!1)},Object.defineProperty(n.prototype,"UserModel",{set:function(t){this._userModel=t,this._watchData()},enumerable:!0,configurable:!0}),n}(eui.Component);t.UserHead=e,__reflect(e.prototype,"LC.UserHead")}(LC||(LC={}));var LC;!function(t){var e=function(e){function n(){var t=e.call(this)||this;return t._sourceCardList=[],t._targetCardList=[],t._isSourceCard=!0,t.skinName="Skin.GameLayer",t.percentWidth=100,t.percentHeight=100,t}return __extends(n,e),n.prototype.init=function(){this._initCardModDirection(),this._initLayoutSeats(),e.prototype.init.call(this),this._initTestPanel(),this._initCardPointer(),this._initUsersSeats(),console.log("进入游戏层")},n.prototype._initCardPointer=function(){this._cardPointer=new t.CardPointer,this._cardPointer.visible=!1,this.actHandler.Ctrl=new t.ActHandlerController},n.prototype._initTestPanel=function(){this.cardSelect_Panel.visible=!1,this._addShowCard(17,25),this._addShowCard(33,41),this._addShowCard(49,57),this._addShowCard(65,68),this._addShowCard(81,83)},n.prototype._addShowCard=function(e,n){for(var r=this,i=this.card_Group,o=function(e){var n=new eui.Group;i.addChild(n);var o=new t.Card;o.touchEnabled=!1,o.scaleX=o.scaleY=.5,o.setCardTexture(t.Directions.Down,t.CardState.Stand,e),n.addChild(o);var a=new eui.ToggleButton;a.width=43,a.height=62,a.alpha=0,n.addChild(a),a.addEventListener(egret.Event.CHANGE,function(t){var e=t.target;e.selected?(o.alpha=.3,r._isSourceCard?r._sourceCardList.push(o.value):r._targetCardList.push(o.value)):(o.alpha=1,r._isSourceCard?ArrayUtils.deleteByValue(r._sourceCardList,o.value):ArrayUtils.deleteByValue(r._targetCardList,o.value))},s)},s=this,a=e;n>=a;a++)o(a)},n.prototype._resetTestCard=function(){for(var t=this.card_Group,e=0;e<t.numChildren;e++){var n=t.getChildAt(e),r=n.getChildAt(0);n.getChildAt(1);r.alpha=1}},n.prototype._initLayoutSeats=function(){this._initConfigSeats(),this._hideOrShowAllSeats(!1,this.FourPlayers),this._chooseConfigSeates(t.Config.MaxPlayerCount),this._hideOrShowAllSeats(!0,this.seatsUI)},n.prototype._initConfigSeats=function(){this.FourPlayers=[this.Down,this.Right,this.Up,this.Left],this.ThreePlayers=[this.Down,this.Right,this.Left],this.TwoPlayers=[this.Down,this.Up]},n.prototype._chooseConfigSeates=function(t){switch(t){case 2:this.seatsUI=this.TwoPlayers;break;case 3:this.seatsUI=this.ThreePlayers;break;case 4:this.seatsUI=this.FourPlayers}},n.prototype._hideOrShowAllSeats=function(t,e){for(var n=0,r=e;n<r.length;n++){var i=r[n];i.getChildAt(0).visible=t}},n.prototype._initUsersSeats=function(){for(var e in t.UsersInfo.Instance.UsersList){var n=t.UsersInfo.Instance.UsersList[e];this.seatsUI[n.client_seatID].getChildAt(0).UserModel=n}},n.prototype.registerCustomEvents=function(){this.UIEventList=[CustomEvents.OtherPlayer_EnterROOM,CustomEvents.DealCard,CustomEvents.DrawCard,CustomEvents.BuHua_DealCard,CustomEvents.BuHua_GameCard,CustomEvents.CanAct,CustomEvents.AllUsersReady,CustomEvents.ACT_Aleady,t.SelectCardComplete,CustomEvents.ChangeCard,CustomEvents.CheckOut,CustomEvents.GameOver]},n.prototype.setOnTouchListener=function(){var e=this;this.btn_ready.addEventListener(egret.TouchEvent.TOUCH_TAP,this._onReadyBtnClick,this),this.btn_cancel.addEventListener(egret.TouchEvent.TOUCH_TAP,this._onReadyBtnClick,this),this.back.addEventListener(egret.TouchEvent.TOUCH_TAP,this._backBtnClick,this),this.move.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.mod_up._addOutCard(e.mod_up.direction,35),e.mod_left._addOutCard(e.mod_left.direction,35),e.mod_right._addOutCard(e.mod_right.direction,35),e.mod_down._addOutCard(e.mod_down.direction,35),e.mod_down.addCombToAllCardList(e.mod_down.direction,[],[33,34,35,36],t.CardCombType.MGang),e.mod_up.addCombToAllCardList(e.mod_up.direction,[],[33,34,35,36],t.CardCombType.MGang),e.mod_left.addCombToAllCardList(e.mod_left.direction,[],[33,34,35,36],t.CardCombType.MGang),e.mod_right.addCombToAllCardList(e.mod_right.direction,[],[33,34,35,36],t.CardCombType.MGang)},this),this.dealCard.addEventListener(egret.TouchEvent.TOUCH_TAP,this._onTestBtnClick,this),this.changeCard.addEventListener(egret.TouchEvent.TOUCH_TAP,this._onTestBtnClick,this),this.confirmNextCard.addEventListener(egret.TouchEvent.TOUCH_TAP,this._onTestBtnClick,this),this.selectTargetCard.addEventListener(egret.TouchEvent.TOUCH_TAP,this._onTestBtnClick,this),this.selectSourceCard.addEventListener(egret.TouchEvent.TOUCH_TAP,this._onTestBtnClick,this),this.sure.addEventListener(egret.TouchEvent.TOUCH_TAP,this._onTestBtnClick,this)},n.prototype.removeOnTouchListener=function(){this.btn_ready.removeEventListener(egret.TouchEvent.TOUCH_TAP,this._onReadyBtnClick,this),this.btn_cancel.removeEventListener(egret.TouchEvent.TOUCH_TAP,this._onReadyBtnClick,this),this.back.removeEventListener(egret.TouchEvent.TOUCH_TAP,this._backBtnClick,this),this.dealCard.removeEventListener(egret.TouchEvent.TOUCH_TAP,this._onTestBtnClick,this),this.changeCard.removeEventListener(egret.TouchEvent.TOUCH_TAP,this._onTestBtnClick,this),this.confirmNextCard.removeEventListener(egret.TouchEvent.TOUCH_TAP,this._onTestBtnClick,this),this.selectTargetCard.removeEventListener(egret.TouchEvent.TOUCH_TAP,this._onTestBtnClick,this),this.selectSourceCard.removeEventListener(egret.TouchEvent.TOUCH_TAP,this._onTestBtnClick,this),this.cardSelect_Panel.closeButton.removeEventListener(egret.TouchEvent.TOUCH_TAP,this._onTestBtnClick,this)},n.prototype.watchData=function(){eui.Binding.bindHandler(t.DeskInfo,["deskID"],this._roomNoChange,this),eui.Binding.bindHandler(t.DeskInfo,["gameData"],this._gameDataChange,this),eui.Binding.bindHandler(t.UsersInfo.MySelf,["status"],this._MySelfStatusChange,this)},n.prototype._roomNoChange=function(t){t&&(this.roomNo.text="房间号："+t.toString())},n.prototype._MySelfStatusChange=function(e){e&&e==t.UserState.UNREADY?this.btn_ready.visible=!0:this.btn_ready.visible=!1,e&&e==t.UserState.READY?this.btn_cancel.visible=!0:this.btn_cancel.visible=!1},n.prototype._gameDataChange=function(e){var n=this;if(e&&!ArrayUtils.isEmptyObject(e)){t.DeskInfo.status=e.desk_info.status,this._recoverHandCards(e),this._recoverCombAndOutCards(e),this._setDiscFeng(),t.DeskInfo.remain_count=e.desk_info.remain_cards,this._recoverBanker(e.desk_info.bank_seat_id);var r=egret.setTimeout(function(){n._recoverLightBright(e),clearTimeout(r)},this,300);this._recoverDrawCard(e)}},n.prototype._recoverLightBright=function(e){var n=e.desk_info.cur_speaker_seat_id,r=t.UsersInfo.Instance.getUserBySeatID(n),i=this.seatsUI[r.client_seatID].getChildAt(1);this.disc.lightBright(i.direction)},n.prototype._recoverDrawCard=function(e){var n=e.desk_info.cur_speaker_seat_id,r=t.UsersInfo.Instance.getUserBySeatID(n),i=this.seatsUI[r.client_seatID].getChildAt(1);0!=e.player_info[n].last_card&&i.moveCardToDrawCard(i.direction,e.player_info[n].last_card)},n.prototype._recoverCombAndOutCards=function(e){for(var n=0,r=e.out_cards_info;n<r.length;n++){var i=r[n],o=t.UsersInfo.Instance.getUserBySeatID(i.seat_id),s=this.seatsUI[o.client_seatID].getChildAt(1);for(var a in i.chu){var c=i.chu[a];c.is_robbed||(e.desk_info.cur_speaker_seat_id==i.seat_id&&Number(a)==i.chu.length-1?this._currentOutCardContainer=s._addOutCard(s.direction,c.card,this._cardPointer):s._addOutCard(s.direction,c.card))}this._recoverCombCards(s,i.against)}},n.prototype._recoverHandCards=function(e){for(var n=0,r=e.player_info;n<r.length;n++){var i=r[n],o=t.UsersInfo.Instance.getUserBySeatID(i.seat_id),s=this.seatsUI[o.client_seatID].getChildAt(1);s.initHandCards(s.direction,i.hand_card)}},n.prototype._recoverBanker=function(e){var n=t.UsersInfo.Instance.getUserBySeatID(e);console.log("客户端座位为"+n.client_seatID+"是庄家"),n.isBanker=!0},n.prototype._recoverCombCards=function(e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r],s=[],a=[];switch(o.type){case t.ACT.PENG:this._addCombArray(3,a,o.cards[0]),e.addCombToAllCardList(e.direction,s,a,t.CardCombType.Peng);break;case t.ACT.CHI:a=o.cards,e.addCombToAllCardList(e.direction,s,a,t.CardCombType.Chi);break;case t.ACT.DIAN_GANG:case t.ACT.BU_GANG:this._addCombArray(4,a,o.cards[0]),e.addCombToAllCardList(e.direction,s,a,t.CardCombType.MGang);break;case t.ACT.AN_GANG:this._addCombArray(4,a,o.cards[0]),e.addCombToAllCardList(e.direction,s,a,t.CardCombType.AnGang)
}}},n.prototype._initCardModDirection=function(){this.mod_down.direction=t.Directions.Down,this.mod_right.direction=t.Directions.Right,this.mod_up.direction=t.Directions.Up,this.mod_left.direction=t.Directions.Left},n.prototype.ui_allUsersReady=function(t){this._setDiscFeng()},n.prototype._setDiscFeng=function(){var e=t.UsersInfo.Instance.getUserBySeatID(0),n=this.seatsUI[e.client_seatID].getChildAt(1);this.disc.setDongFengDirection(n.direction)},n.prototype.ui_dealCard=function(e){console.log(this.TAG+" ui_dealCard: "+JSON.stringify(e.data.all_cards));var n=e.data.all_cards;for(var r in n){var i=n[r],o=t.UsersInfo.Instance.getUserBySeatID(i.seat_id);o.status=t.UserState.PLAYING;var s=this.seatsUI[o.client_seatID].getChildAt(1);s.initHandCards(s.direction,i.card_list)}},n.prototype.ui_changeCard=function(e){console.log(this.TAG+" ui_changeCard: "+JSON.stringify(e.data.info));var n=e.data.info,r=t.UsersInfo.Instance.getUserBySeatID(n.seat_id),i=this.seatsUI[r.client_seatID].getChildAt(1);i.initHandCards(i.direction,n.hand_card),14==n.hand_card.length&&(i.removeDrawCard(),i.moveCardToDrawCard(i.direction,n.hand_card[0]))},n.prototype.ui_buHuaDealCard=function(e){console.log(this.TAG+" ui_dealCard: "+JSON.stringify(e.data.info));var n=e.data.info,r=t.UsersInfo.Instance.getUserBySeatID(n.seat_id);console.log("客户端座位号为"+r.client_seatID+"发牌补花");var i=this.seatsUI[r.client_seatID].getChildAt(1);i.appliqueCards(i.direction,n.hua_card,n.bu_cards)},n.prototype.ui_buHuaGameCard=function(e){console.log(this.TAG+" ui_dealCard: "+JSON.stringify(e.data.info));var n=e.data.info,r=t.UsersInfo.Instance.getUserBySeatID(n.seat_id);console.log("客户端座位号为"+r.client_seatID+"游戏补花");var i=this.seatsUI[r.client_seatID].getChildAt(1);i.addDrawCard(i.direction,n.hua_card_list[0],t.CardState.Stand)},n.prototype.ui_otherPlayerEnterRoom=function(t){console.log(this.TAG+" ui_otherPlayerEnterRoom: "+JSON.stringify(t.data));var e=t.data.user,n=this.seatsUI[e.client_seatID].getChildAt(0);n.UserModel=e},n.prototype.ui_checkOut=function(e){console.log(this.TAG+" ui_checkOut: "+JSON.stringify(e.data.info));var n=e.data.info;this.actHandler.hide();var r=new t.GameResult(n);t.SceneManager.Instance.runningScene.addChild(r)},n.prototype.ui_gameOver=function(e){console.log(this.TAG+" ui_gameOver: "+JSON.stringify(e.data.info));var n=e.data.info;t.DeskInfo.status=t.DeskStatus.OVER;for(var r in n.player_info){var i=t.UsersInfo.Instance.getUserBySeatID(Number(r)),o=this.seatsUI[i.client_seatID].getChildAt(1);o.fallDownAllHandCards(o.direction,n.player_info[r])}t.UsersInfo.Instance.reSetAllUsersStatus()},n.prototype.ui_drawCard=function(e){console.log(this.TAG+" ui_drawCard: "+JSON.stringify(e.data.info));var n=e.data.info,r=t.UsersInfo.Instance.getUserBySeatID(n.seat_id),i=this.seatsUI[r.client_seatID].getChildAt(1);this.disc.lightBright(i.direction),i.addDrawCard(i.direction,n.card_list[0],t.CardState.Stand)},n.prototype.ui_canAct=function(t){console.log(this.TAG+" ui_canAct: "+JSON.stringify(t.data.info));var e=t.data.info;this._parseActInfo(e)},n.prototype._parseActInfo=function(e){var n=t.UsersInfo.Instance.getUserBySeatID(e.seat_id),r=this.seatsUI[n.client_seatID].getChildAt(1);for(var i in e.act_info)switch(console.log("_parseActInfo "+t.ACT[i]),Number(i)){case t.ACT.CHU:r.canOutACard=!0,this.disc.lightBright(r.direction),r.moveCardToDrawCard(r.direction,e.act_info[i].card);break;case t.ACT.GUO:case t.ACT.CHI:case t.ACT.PENG:case t.ACT.AN_GANG:case t.ACT.BU_GANG:case t.ACT.DIAN_GANG:case t.ACT.DIAN_HU:case t.ACT.ZI_MO:this.actHandler.visible=!0,this.actHandler.addLayout(Number(i),e.act_info[i]);break;case t.ACT.TING:}},n.prototype.ui_selectCardComplete=function(t){console.log(this.TAG+" ui_selectCardComplete: "+JSON.stringify(t.data.cardValue));var e=t.data.cardValue;this._ctrl.actChuCard(e)},n.prototype.ui_actAleady=function(t){console.log(this.TAG+" ui_actAleady: "+JSON.stringify(t.data.info));var e=t.data.info;this._parseActResponse(e)},n.prototype._parseActResponse=function(e){var n=t.UsersInfo.Instance.getUserBySeatID(e.seat_id),r=this.seatsUI[n.client_seatID].getChildAt(1);this.actHandler.hide();var i=[],o=[];switch(console.log("_parseActResponse "+t.ACT[e.act_type]),e.act_type){case t.ACT.CHU:this._currentOutCardContainer=r.outACard(r.direction,e.card_list[0],this._cardPointer);break;case t.ACT.PENG:this.disc.lightBright(r.direction),this._addCombArray(2,i,e.card_list[0]),this._addCombArray(3,o,e.card_list[0]),r.addCombToAllCardList(r.direction,i,o,t.CardCombType.Peng),this._currentOutCardContainer&&this._currentOutCardContainer.parent.removeChild(this._currentOutCardContainer);break;case t.ACT.CHI:this.disc.lightBright(r.direction),i=ArrayUtils.DeepCopy(e.card_list),o=ArrayUtils.DeepCopy(e.card_list);var s=this._currentOutCardContainer.getChildAt(0).value;ArrayUtils.deleteByValue(i,s),r.addCombToAllCardList(r.direction,i,o,t.CardCombType.Chi),this._currentOutCardContainer&&this._currentOutCardContainer.parent.removeChild(this._currentOutCardContainer);break;case t.ACT.DIAN_GANG:this._addCombArray(3,i,e.card_list[0]),this._addCombArray(4,o,e.card_list[0]),r.addCombToAllCardList(r.direction,i,o,t.CardCombType.MGang),this._currentOutCardContainer&&this._currentOutCardContainer.parent.removeChild(this._currentOutCardContainer);break;case t.ACT.BU_GANG:r.buGang(r.direction,e.card_list[0]);break;case t.ACT.AN_GANG:this._addCombArray(4,i,e.card_list[0]),this._addCombArray(4,o,e.card_list[0]),r.addCombToAllCardList(r.direction,i,o,t.CardCombType.AnGang);break;case t.ACT.DIAN_HU:break;case t.ACT.ZI_MO:}},n.prototype._addCombArray=function(t,e,n){for(var r=0;t>r;r++)e.push(n)},n.prototype._onReadyBtnClick=function(e){var n=e.currentTarget;n==this.btn_ready?(t.DeskInfo.status==t.DeskStatus.OVER&&this._reSetRoom(),this._ctrl.onMySelfReady(t.ReadyState.GetReady)):n==this.btn_cancel&&this._ctrl.onMySelfReady(t.ReadyState.Cancel)},n.prototype._backBtnClick=function(t){this._ctrl.exitRoom()},n.prototype._reSetRoom=function(){this.disc.reSetDisc(),t.UsersInfo.Instance.reSetAllUsersBanker();for(var e=0,n=this.seatsUI;e<n.length;e++){var r=n[e],i=r.getChildAt(1);i.reSetMod()}},n.prototype._onTestBtnClick=function(e){var n=e.currentTarget;switch(n){case this.dealCard:this._ctrl.test_Send(t.TestType.DealCard,this._targetCardList);break;case this.changeCard:this._ctrl.test_Send(t.TestType.ChangeCard,this._targetCardList,this._sourceCardList);break;case this.confirmNextCard:this._ctrl.test_Send(t.TestType.ConfirmNextCard,this._targetCardList);break;case this.selectSourceCard:this.cardSelect_Panel.visible=!0,this._isSourceCard=!0,this._sourceCardList=[],this._resetTestCard();break;case this.selectTargetCard:this.cardSelect_Panel.visible=!0,this._isSourceCard=!1,this._targetCardList=[],this._resetTestCard();break;case this.sure:this.cardSelect_Panel.visible=!1,console.log("sourceCard:",this._sourceCardList,"\ntargetCard:",this._targetCardList)}},n}(t.Layer);t.GameLayer=e,__reflect(e.prototype,"LC.GameLayer")}(LC||(LC={}));var LC;!function(t){var e=function(e){function n(){var t=e.call(this)||this;return t.skinName="Skin.ActHandler",t}return __extends(n,e),n.prototype.init=function(){e.prototype.init.call(this),this._actList=(n={},n[t.ACT.GUO]={obj:this.Guo},n[t.ACT.CHI]={obj:this.Chi},n[t.ACT.PENG]={obj:this.Peng},n[t.ACT.AN_GANG]={obj:this.Gang},n[t.ACT.BU_GANG]={obj:this.Gang},n[t.ACT.DIAN_GANG]={obj:this.Gang},n[t.ACT.DIAN_HU]={obj:this.Hu},n[t.ACT.ZI_MO]={obj:this.Hu},n),this._clearLayout();var n},n.prototype._clearLayout=function(){for(var t in this._actList){var e=this._actList[t].obj;this._showAct(e,!1),delete this._actList[t].info}},n.prototype.setOnTouchListener=function(){this.Chi.addEventListener(egret.TouchEvent.TOUCH_TAP,this._actButtonClick,this),this.Peng.addEventListener(egret.TouchEvent.TOUCH_TAP,this._actButtonClick,this),this.Gang.addEventListener(egret.TouchEvent.TOUCH_TAP,this._actButtonClick,this),this.Hu.addEventListener(egret.TouchEvent.TOUCH_TAP,this._actButtonClick,this),this.Guo.addEventListener(egret.TouchEvent.TOUCH_TAP,this._actButtonClick,this)},n.prototype.removeOnTouchListener=function(){this.Chi.removeEventListener(egret.TouchEvent.TOUCH_TAP,this._actButtonClick,this),this.Peng.removeEventListener(egret.TouchEvent.TOUCH_TAP,this._actButtonClick,this),this.Gang.removeEventListener(egret.TouchEvent.TOUCH_TAP,this._actButtonClick,this),this.Hu.removeEventListener(egret.TouchEvent.TOUCH_TAP,this._actButtonClick,this),this.Guo.removeEventListener(egret.TouchEvent.TOUCH_TAP,this._actButtonClick,this)},n.prototype._actButtonClick=function(t){var e=t.currentTarget;switch(console.log(e.mcLink),e){case this.Guo:this.hide(),this._actGuoClick();break;case this.Chi:this._actChiClick();break;case this.Peng:this._actPengClick();break;case this.Gang:this._actGangClick();break;case this.Hu:this._actHuClick()}},n.prototype._actGuoClick=function(){console.log("_actGuoClick"),this._ctrl.actGuo()},n.prototype._actChiClick=function(){console.log("_actChiClick");var e=this._actList[t.ACT.CHI].info;if(1==e.length)this._ctrl.actChi(e[0]);else{this.chiComb_Group.visible=!0,this.chiComb_Group.removeChildren();for(var n=0,r=e;n<r.length;n++){var i=r[n],o=new t.ComboCards;o.scaleX=o.scaleY=.6,o.setCombCardsTexture(t.Directions.Down,i,t.CardCombType.Chi),o.addEventListener(egret.TouchEvent.TOUCH_TAP,this._chiCombCardHandler,this),this.chiComb_Group.addChild(o)}}},n.prototype._chiCombCardHandler=function(e){var n=e.currentTarget,r=this.chiComb_Group.getChildIndex(n),i=this._actList[t.ACT.CHI].info;this.hide(),this.chiComb_Group.visible=!1,this.chiComb_Group.removeChildren(),this._ctrl.actChi(i[r])},n.prototype._actPengClick=function(){console.log("_actPengClick"),this._ctrl.actPeng()},n.prototype._actHuClick=function(){console.log("_actHuClick"),this._actList[t.ACT.DIAN_HU].info?this._ctrl.actHu(t.ACT.DIAN_HU):this._actList[t.ACT.ZI_MO].info&&this._ctrl.actHu(t.ACT.ZI_MO)},n.prototype._actGangClick=function(){console.log("_actGangClick"),this._actList[t.ACT.DIAN_GANG].info?this._ctrl.actGang(t.ACT.DIAN_GANG):this._actList[t.ACT.BU_GANG].info?this._ctrl.actGang(t.ACT.BU_GANG,this._actList[t.ACT.BU_GANG].info[0]):this._actList[t.ACT.AN_GANG].info&&this._ctrl.actGang(t.ACT.AN_GANG,this._actList[t.ACT.AN_GANG].info[0])},n.prototype.addLayout=function(t,e){this._showAct(this._actList[t].obj,!0),this._actList[t].info=e},n.prototype._showAct=function(t,e){t.visible=e,t.includeInLayout=e},n.prototype.hide=function(){this.visible=!1,this.chiComb_Group.visible=!1,this.chiComb_Group.removeChildren(),this._clearLayout()},n}(t.Layer);t.ActHandler=e,__reflect(e.prototype,"LC.ActHandler")}(LC||(LC={}));var LC;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e._moveDist=-10,e.width=50,e.height=64,e}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this);var e=new eui.Image;e.source="outCardPointer_png",this.addChild(e),e.anchorOffsetY=e.height/2,this.start()},e.prototype.start=function(){var t=this.y;egret.Tween.removeTweens(this),egret.Tween.get(this,{loop:!0}).to({y:t+this._moveDist},500).to({y:t},500)},e}(t.Layer);t.CardPointer=e,__reflect(e.prototype,"LC.CardPointer")}(LC||(LC={}));var LC;!function(t){var e=function(e){function n(){var t=e.call(this)||this;return t.skinName="Skin.Disc",t}return __extends(n,e),n.prototype.init=function(){this.anim_dice.MC.stop(),this.anim_dice.visible=!1,this.dice.visible=!1,this.remain_count.visible=!1,this._setLightsVisible(!1),e.prototype.init.call(this)},n.prototype._setLightsVisible=function(t){for(var e=0;e<this.lights.numChildren;e++)this.lights.getChildAt(e).visible=t},n.prototype._setDice=function(t){var e=this;if(null!=t)if(-1==t[0]&&-1==t[1])this.anim_dice.visible=!0,this.anim_dice.MC.play(-1);else{this.dice.getChildAt(0).source=RES.getRes("s"+t[0]+"_png"),this.dice.getChildAt(1).source=RES.getRes("s"+t[1]+"_png");var n=egret.setTimeout(function(){e.anim_dice.MC.stop(),e.anim_dice.visible=!1,e.dice.visible=!0,clearTimeout(n)},this,1e3)}},n.prototype._setRemainCount=function(t){t&&(this.remain_count.text="剩余:"+t.toString()+"张牌"),this.remain_count.visible=!0},n.prototype.watchData=function(){eui.Binding.bindHandler(t.DeskInfo,["diceValue"],this._setDice,this),eui.Binding.bindHandler(t.DeskInfo,["remain_count"],this._setRemainCount,this)},n.prototype.setDongFengDirection=function(e){switch(e){case t.Directions.Down:this.img_fengDir.rotation=0;break;case t.Directions.Right:this.img_fengDir.rotation=270;break;case t.Directions.Up:this.img_fengDir.rotation=180;break;case t.Directions.Left:this.img_fengDir.rotation=90}},n.prototype.lightBright=function(t,e){this._setLightsVisible(!1);var n=this.lights.getChildAt(t);n.visible=!0,egret.Tween.get(n,{loop:!0}).to({alpha:0},200,egret.Ease.quadIn).to({alpha:1},200,egret.Ease.quadIn)},n.prototype.reSetDisc=function(){this._setLightsVisible(!1),this.anim_dice.MC.stop(),this.anim_dice.visible=!1,this.dice.visible=!1,this.remain_count.visible=!1},n}(t.Layer);t.Disc=e,__reflect(e.prototype,"LC.Disc")}(LC||(LC={}));var LC;!function(t){var e=function(e){function n(){var t=e.call(this)||this;return t.skinName="Skin.HallLayer",t.percentWidth=100,t.percentHeight=100,t}return __extends(n,e),n.prototype.init=function(){e.prototype.init.call(this),this._ctrl.connectSocket()},n.prototype.setOnTouchListener=function(){this.btn_playGround.addEventListener(egret.TouchEvent.TOUCH_TAP,this._onPlayGroundBtnClick,this),this.btn_friendRoom.addEventListener(egret.TouchEvent.TOUCH_TAP,this._onFriendRoomBtnClick,this),this.back_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this._onBackBtnClick,this)},n.prototype.removeOnTouchListener=function(){this.btn_playGround.removeEventListener(egret.TouchEvent.TOUCH_TAP,this._onPlayGroundBtnClick,this),this.btn_friendRoom.removeEventListener(egret.TouchEvent.TOUCH_TAP,this._onFriendRoomBtnClick,this),this.back_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this._onBackBtnClick,this)},n.prototype.registerCustomEvents=function(){this.UIEventList=[]},n.prototype._onPlayGroundBtnClick=function(){console.log("_onPlayGroundBtnClick")},n.prototype._onFriendRoomBtnClick=function(){console.log("_onFriendRoomBtnClick");var e=new t.SelectRoom;e.Ctrl=new t.SelectRoomController,t.SceneManager.Instance.runningScene.addChild(e)},n.prototype._onBackBtnClick=function(){var e=new t.LoginScene;t.SceneManager.Instance.replaceScene(e)},n}(t.Layer);t.HallLayer=e,__reflect(e.prototype,"LC.HallLayer")}(LC||(LC={}));var LC;!function(t){var e=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.init=function(){t.prototype.init.call(this),this.percentWidth=100,this.percentHeight=100;var e=new eui.Image;e.source=RES.getRes("PreLoadingBg_png"),e.percentWidth=100,e.percentHeight=100,this.addChild(e);var n=new eui.Group;n.horizontalCenter=0,n.bottom=20,this.addChild(n);var r=new eui.Image;r.source=RES.getRes("PreLoadingBarBg_png"),n.addChild(r),this.pgBar=new eui.Image,this.pgBar.source=RES.getRes("PreLoadingBar_png"),this.pgBar.left=30,this.pgBar.verticalCenter=-5,n.addChild(this.pgBar),this.pgBarWidth=this.pgBar.width,this.proLabel=new eui.Label,this.proLabel.horizontalCenter=0,this.proLabel.verticalCenter=-5,this.proLabel.textAlign="center",this.proLabel.size=24,this.proLabel.textColor=16777215,this.proLabel.bold=!0,this.proLabel.stroke=1,this.proLabel.strokeColor=0,n.addChild(this.proLabel),this.proLabel.text="0%",this.pgBar.width=0},e.prototype.setProgress=function(t,e){var n=Math.round(t/e*100);this.proLabel.text=n+"%",this.pgBar.width=this.pgBarWidth*(t/e)},e}(t.Layer);t.LoadingLayer=e,__reflect(e.prototype,"LC.LoadingLayer")}(LC||(LC={}));var LC;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.skinName="Skin.LoginLayer",e.percentWidth=100,e.percentHeight=100,e}return __extends(e,t),e.prototype.init=function(){t.prototype.init.call(this)},e.prototype.setOnTouchListener=function(){this.btn_login.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onLoginClick,this)},e.prototype.removeOnTouchListener=function(){this.btn_login.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onLoginClick,this)},e.prototype.registerCustomEvents=function(){this.UIEventList=[]},e.prototype.onLoginClick=function(){this._ctrl.sendDebugLoginReq(this.edit_name.text,this.edit_psw.text)},e}(t.Layer);t.LoginLayer=e,__reflect(e.prototype,"LC.LoginLayer")}(LC||(LC={}));var LC;!function(t){var e=function(e){function n(t){var n=e.call(this)||this;return n._numberBtns=[],n.skinName="Skin.GameResult",n._data=t,n}return __extends(n,e),n.prototype.init=function(){e.prototype.init.call(this),this._setTotalResult()},n.prototype._setTotalResult=function(){var e=this._data.total_points;for(var n in this._data.total_points){var r=t.UsersInfo.Instance.getUserBySeatID(Number(n)),i=new eui.Label;this.total_Group.addChild(i),i.text="玩家"+r.user_id+"的总分："+e[n]}},n.prototype.setOnTouchListener=function(){this.closeButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._onCloseClick,this)},n.prototype.removeOnTouchListener=function(){this.closeButton.removeEventListener(egret.TouchEvent.TOUCH_TAP,this._onCloseClick,this)},n.prototype.registerCustomEvents=function(){this.UIEventList=[]},n.prototype._onCloseClick=function(){this.parent.removeChild(this)},n.prototype.watchData=function(){},n}(t.Layer);t.GameResult=e,__reflect(e.prototype,"LC.GameResult")}(LC||(LC={}));var LC;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e._numberBtns=[],e.skinName="Skin.JoinRoom",e.percentWidth=100,e.percentHeight=100,e}return __extends(e,t),e.prototype.init=function(){t.prototype.init.call(this),this.label_roomNo.text="";for(var e=0;12>e;e++)this._numberBtns.push(this.group_number_btn.getChildAt(e))},e.prototype.setOnTouchListener=function(){this.closeButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._onCloseClick,this),this.group_number_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this._onNumberBtnClick,this)},e.prototype.removeOnTouchListener=function(){this.closeButton.removeEventListener(egret.TouchEvent.TOUCH_TAP,this._onCloseClick,this),this.group_number_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this._onNumberBtnClick,this)},e.prototype.registerCustomEvents=function(){this.UIEventList=[]},e.prototype._onCloseClick=function(){this.parent.removeChild(this)},e.prototype._onNumberBtnClick=function(t){for(var e=0;e<this._numberBtns.length;e++)t.target==this._numberBtns[e]&&this._changeRoomNumber(e)},e.prototype._changeRoomNumber=function(t){if(10>t){if(this.label_roomNo.text.length>=6)return void console.log("房间号只能为6位数");this.label_roomNo.text=this.label_roomNo.text+t.toString()}else if(10==t){var e=this.label_roomNo.text;e=e.substr(0,e.length-1),this.label_roomNo.text=e}else 11==t&&(6!=this.label_roomNo.text.length?console.log("房间号不存在"):this._ctrl.joinFriendRoom(Number(this.label_roomNo.text)))},e}(t.Layer);t.JoinRoom=e,__reflect(e.prototype,"LC.JoinRoom")}(LC||(LC={}));var LC;!function(t){var e=function(e){function n(){var t=e.call(this)||this;return t.skinName="Skin.SelectRoom",t.percentWidth=100,t.percentHeight=100,t}return __extends(n,e),n.prototype.init=function(){e.prototype.init.call(this)},n.prototype.setOnTouchListener=function(){this.closeButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._onCloseClick,this),this.btn_joinRoom.addEventListener(egret.TouchEvent.TOUCH_TAP,this._onJoinRoomClick,this),this.btn_createRoom.addEventListener(egret.TouchEvent.TOUCH_TAP,this._onCreateRoomClick,this)},n.prototype.removeOnTouchListener=function(){this.closeButton.removeEventListener(egret.TouchEvent.TOUCH_TAP,this._onCloseClick,this),this.btn_joinRoom.removeEventListener(egret.TouchEvent.TOUCH_TAP,this._onJoinRoomClick,this),this.btn_createRoom.removeEventListener(egret.TouchEvent.TOUCH_TAP,this._onCreateRoomClick,this)},n.prototype.registerCustomEvents=function(){this.UIEventList=[]},n.prototype._onJoinRoomClick=function(){console.log("_onJoinRoomClick");var e=new t.JoinRoom;e.Ctrl=new t.JoinRoomController,t.SceneManager.Instance.runningScene.addChild(e)},n.prototype._onCreateRoomClick=function(){console.log("_onCreateRoomClick"),this._ctrl.createRoom()},n.prototype._onCloseClick=function(){this.parent.removeChild(this)},n}(t.Layer);t.SelectRoom=e,__reflect(e.prototype,"LC.SelectRoom")}(LC||(LC={}));